# Googleスプレッドシート連携徹底活用

VoiceflowのGoogleスプレッドシート連携機能を使うと、Excelライクに管理がかんたんなデータベースとして活用ができるので、スキル開発の幅が一気に広がります。ぜひ活用してワンランク上のスキルを作ってみましょう。

## 基本的な使い方

のっけからで恐縮ですが、紙面の都合上、基本的な使い方は私のブログの記事をご覧ください。以下にご紹介します。

### 豆知識スキル

- Voiceflow TIPS #7 Googleスプレッドシート連携で作る豆知識スキル - kun432's blog
https://kun432.hatenablog.com/entry/voiceflow_tips_7_fact_skill_integrated_with_google_sheets

初歩のAlexaスキル開発のサンプルとしてもよく取り上げられている「豆知識」スキルをGoogleスプレッドシートと連携させて作ります。Googleスプレッドシート側に豆知識の「ネタ」をたくさん登録しておいて、ランダムに呼び出すというものです。

### データベーススキル

- Voiceflow TIPS #12 Googleスプレッドシート連携で作るゼロカロリースキルもどき 〜スプレッドシートの検索〜 - kun432's blog
https://kun432.hatenablog.com/entry/voiceflow_tips_12_retrieve_from_google_spreadsheet
- Voiceflow TIPS #14 Googleスプレッドシート連携で作るゼロカロリースキルもどき 〜スプレッドシートへの登録〜 - kun432's blog
https://kun432.hatenablog.com/entry/voiceflow_tips_14_insert_data_into_google_sheets
- Voiceflow TIPS #18 Googleスプレッドシート連携で作るゼロカロリースキルもどき 〜スプレッドシートの更新〜 - kun432's blog
https://kun432.hatenablog.com/entry/voiceflow_tips_18_update_data_with_google_sheets
- Voiceflow TIPS #19 Googleスプレッドシート連携で作るゼロカロリースキルもどき 〜スプレッドシートの削除〜 - kun432's blog
https://kun432.hatenablog.com/entry/voiceflow_tips_19_delete_data_with_google_sheets

2019年のAlexaスキルハッカソン大阪で話題になっていた、がおまるさん（@gaomar）の「ゼロカロリースキル」をGoogleスプレッドシート連携だけで作るというものです。データベースの基本となる、一連のCRUD操作（Create:登録、 Retrieve:参照、Update:更新、Delete:削除）を4回にわけてご紹介しています。

## Googleスプレッドシート側の機能を使う

## Googleスプレッドシートを使う場合の注意

## Googleスプレッドシートを使うメリットとデメリット

最初にGoogleスプレッドシートと連携させるメリット・デメリットを以下に記載します。メリット・デメリットを正しく理解して活用することが重要です。

### メリット

#### 1. 簡易な永続的データベースとして使える

冒頭に記載したとおり、Googleスプレッドシートをデータベースとして扱えます。つまり、データの登録・参照・更新・削除ができます。標準的なAlexaスキルではDynamoDBなどを使うことが多いと思いますが、Excelのほうが簡単に使えますよね！
また、スキル初回起動時にユーザの名前を記録しておいて、次回のスキル起動時にその名前を使って挨拶をする、というような場合

#### 2. 横断的・集計的なデータの操作ができる

上で述べたような永続なデータの扱いは、Voiceflowの場合、Googleスプレッドシートを使わなくても、実は変数だけで実現できます（Voiceflowの変数は、デフォルトで永続になっています。）ただし、この変数はユーザごとにVoiceflow内で管理されており、開発者側からは見ることも触ることもできません。セキュリティやプライバシーの観点ではより安全ではあるのですが、たとえば、クイズスキルなどで点数でランキングしたい、というような横断的・集計的な操作ができません。こういったデータはGoogleスプレッドシートを使うと非常にかんたんに

#### 4. スキル再審査不要でデータの変更ができる。

スキル内にデータをもたせることもできますが、その場合、データを更新するたびに再審査が必要になります。Googleスプレッドシートを使うと、データの部分に関してはスキルの外側になるため、スキルの再審査不要でデータの

### デメリット

### 1. やや遅い、やや安定していない

Googleスプレッドシートへのアクセスは、一般的なデータベースと比べると少し時間がかかる上、安定していない感があります。スキル内で何回もスプレッドシートにアクセスすると、レスポンスが気になる場合もあるかもしれませんし、必然的にエラーが発生する可能性もあがります。ユーザとアレクサのやりとりのテンポ・リズム感に影響を与えないレベルに留めることと、エラーが発生した場合も十分に考慮することをオススメします。

### 2. 大量のデータには向いていない

どこまで使えるか？という限界を確認したわけではありませんが、行やカラムが多い・セル内の1つ1つのデータが大きい、というような場合、エラーになることがあります。大量のデータを扱うことが想定される場合は、別のデータベースを使うことをおススメします。

### 3. 複雑な検索などはできない
